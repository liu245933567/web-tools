generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

// 用户购买记录
model AskBuyLog {
  id          Int      @id @default(autoincrement())
  description String?
  amount      Int
  user        AskUser? @relation(fields: [userId], references: [id])
  userId      Int?
}

// 用户账户
model AskAccount {
  id        Int     @id @default(autoincrement())
  balance   Int     @default(0)
  user      AskUser @relation(fields: [askUserId], references: [id])
  askUserId Int     @unique
}

// 用户
model AskUser {
  id         Int         @id @default(autoincrement())
  name       String
  qq         String      @unique
  role       String
  buyLog     AskBuyLog[]
  account    AskAccount?
  AskGroup   AskGroup    @relation(fields: [askGroupId], references: [id])
  askGroupId Int
}

// 用户所在群组
model AskGroup {
  id          Int           @id @default(autoincrement())
  name        String
  users       AskUser[]
  AskGroupLog AskGroupLog[]
  AskProduct  AskProduct[]
}

model AskGroupLog {
  id          Int      @id @default(autoincrement())
  description String
  AskGroup    AskGroup @relation(fields: [askGroupId], references: [id])
  askGroupId  Int
}

// 商品
model AskProduct {
  id          Int      @id @default(autoincrement())
  name        String
  description String
  price       Int
  AskGroup    AskGroup @relation(fields: [askGroupId], references: [id])
  askGroupId  Int
}
